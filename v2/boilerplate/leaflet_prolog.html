<!DOCTYPE html>
<html>
<head>
	
	<title>RUSA Permanents</title>

	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.2/dist/leaflet.css" />
	<script
	src="https://unpkg.com/leaflet@1.0.2/dist/leaflet.js"></script>

        <script src="lib/Leaflet.MakiMarkers.js"></script>

        <!-- Marker clustering -->
	<link rel="stylesheet"
        href="https://unpkg.com/leaflet.markercluster@1.0.0/dist//MarkerCluster.css" />
	<link rel="stylesheet"
        href="https://unpkg.com/leaflet.markercluster@1.0.0/dist//MarkerCluster.Default.css" />
	<script
        src="https://unpkg.com/leaflet.markercluster@1.0.0/dist//leaflet.markercluster-src.js">
        </script>

       <script>

       function countPerms (cluster) {
                var children = cluster.getAllChildMarkers();
                var count = 0;
                children.forEach( function( child ) {
                    if (child.options.hasOwnProperty('count')) {
                        count += child.options.count;
                    } else {
                        console.log(child);
                        count += 1;
                    }});
                return count;
       }
       function customIcon (cluster) {
		//var childCount = cluster.getChildCount();
                var childCount = countPerms(cluster);

		var c = ' marker-cluster-';
		if (childCount < 5) {
			c += 'small';
		} else if (childCount < 20) {
			c += 'medium';
		} else {
			c += 'large';
		}

		return new L.DivIcon(
                    {  html: '<div><span>' + childCount + '</span></div>',
		       className: 'marker-cluster' + c, iconSize: new
                       L.Point(40, 40)
		       });
	}
       </script>

<style>
body {
    padding: 0;
    margin: 0;
}
html, body, #mapid {
    height: 100%;
}
.rider-icon { background-color: #00cc00;
               color: #ff0000;
               width: auto; }
         }
</style>
</head>
<body>




<div id="mapid"></div>
<script>

	var mymap = L.map('mapid').setView([37.0172494,-97.1836641], 4);

	L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWljaGFseW91bmciLCJhIjoiY2l3c2xxY3gwMDA0NTJ1cXJsZW5yZDk5NSJ9.IWl2i9omf-ATaiGSNA7STw', {
		maxZoom: 18,
		attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
			'<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
			'Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
		id: 'mapbox.streets'
	}).addTo(mymap);

       	var markers = L.markerClusterGroup(
                { iconCreateFunction: customIcon,
                  disableClusteringAtZoom: 17
                });

        L.MakiMarkers.accessToken = "pk.eyJ1IjoibWljaGFseW91bmciLCJhIjoiY2l3c2xxY3gwMDA0NTJ1cXJsZW5yZDk5NSJ9.IWl2i9omf-ATaiGSNA7STw";


       var icon100 = L.MakiMarkers.icon({icon: "bicycle",
                                         color: "#F0FF32",
                                         size: "m"});

       var icon200 = L.MakiMarkers.icon({icon: "bicycle",
                                         color: "#8CD978",
                                         size: "m"});

       var icon300 = L.MakiMarkers.icon({icon: "bicycle",
                                         color: "#64FEFF",
                                         size: "m"});

       var icon400 = L.MakiMarkers.icon({icon: "bicycle",
                                         color: "#757EFF",
                                         size: "m"});

       var icon600 = L.MakiMarkers.icon({icon: "bicycle",
                                         color: "#FD8F73",
                                         size: "m"});

       var icon1000 = L.MakiMarkers.icon({icon: "bicycle",
                                         color: "#FC5655",
                                         size: "m"});

       var icon1200 = L.MakiMarkers.icon({icon: "bicycle",
                                         color: "#D930FF",
                                         size: "m"});

